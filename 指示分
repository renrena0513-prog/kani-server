# 仕様変更：FSストック3つで即+1（DB更新＆カットイン）

目的：
- FreeSpin図柄（is_free_spin_stock）が3つ貯まった時点で、その場で free_spins_remaining を +1 する。
- 3つ目が出た瞬間に「FreeSpin +1」のカットイン演出を出す。
- 7リール目でまとめて加算する方式はやめて、増加タイミングをラウンド境界から分離して、フロントの状態不整合（開始ボタン押せない等）を減らす。

対象：
- SQL/RPC: slot_spin_reel（FS中の処理）
- フロント: event/slot.html（spinReelの成功ハンドリング）

要件：
1) FS中に free_spin_stocks を増やし、>=3 になった時点で
   - free_spin_stocks を 3 減らし
   - free_spins_remaining を 1 増やす（必要なら複数回変換もOK）
   - レスポンスに bonus_added（今回加算した回数）を含める
2) フロントは slot_spin_reel のレスポンスで bonus_added > 0 のとき
   - 3つ目が出たタイミングで「FreeSpin +1」カットインを表示する
3) UIの既存仕様（FS開始ボタン/残り表示/STOP挙動）は変えない
4) 差分は最小、既存のFS終了時ロジックは破綻しないように調整

成果物：
- SQL差分（関数更新）
- フロント差分（カットイン追加）
- 手動テスト（ストック3つで即+1が起きる、リロード耐性）
ひとつだけ注意

この変更を入れるなら、今のSQLにある「7リール目で stock 変換して extra_spins を足す」部分は 二重加算になる可能性があるので、

即時変換に統一（7リール目では変換しない）
or

7リール目側は「念のため残りstockだけ処理」みたいに整理

のどっちかに寄せる必要があります。