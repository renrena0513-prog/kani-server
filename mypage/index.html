<!DOCTYPE html>
<html lang="ja">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="„Åã„Å´„Çµ„Éº„Éê„Éº - „Éû„Ç§„Éö„Éº„Ç∏">
    <title>„Éû„Ç§„Éö„Éº„Ç∏ | „Åã„Å´„Çµ„Éº„Éê„Éº„Ç§„Éô„É≥„Éà</title>

    <!-- Google Fonts -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link
        href="https://fonts.googleapis.com/css2?family=Noto+Serif+JP:wght@400;500;600;700&family=M+PLUS+Rounded+1c:wght@400;500;700&display=swap"
        rel="stylesheet">

    <!-- Bootswatch Lux (Bootstrap 5.3.3) -->
    <link href="https://cdn.jsdelivr.net/npm/bootswatch@5.3.3/dist/lux/bootstrap.min.css" rel="stylesheet">
    <link rel="stylesheet" href="../styles.css">

    <style>
        :root {
            --primary-purple: #6b5b95;
            --deep-purple: #4a3f6b;
            --cream: #faf5e8;
            --gold: #d4a853;
            --btn-gold: #c29544;
            --font-title: 'Noto Serif JP', serif;
            --font-body: 'M PLUS Rounded 1c', sans-serif;
        }

        .btn-gold {
            background-color: var(--gold);
            border: none;
        }

        .btn-gold:hover {
            background-color: var(--btn-gold);
            color: white;
        }


        body {
            font-family: var(--font-body);
            background: linear-gradient(180deg, #6b5b95 0%, #5a4d80 50%, #4a3f6b 100%);
            min-height: 100vh;
            background-attachment: fixed;
        }

        .page-header {
            font-family: var(--font-title);
            color: var(--cream);
            text-shadow: 2px 2px 8px rgba(0, 0, 0, 0.3);
        }

        .back-button {
            font-family: var(--font-body);
            font-size: 1rem;
            padding: 10px 25px;
            border-radius: 12px;
            border: 2px solid rgba(255, 255, 255, 0.6);
            background: rgba(255, 255, 255, 0.1);
            backdrop-filter: blur(8px);
            color: white;
            text-decoration: none;
            transition: all 0.3s ease;
        }

        .back-button:hover {
            background: rgba(255, 255, 255, 0.2);
            border-color: #fff;
            color: white;
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.2);
        }

        .profile-card {
            background: rgba(255, 255, 255, 0.95);
            border-radius: 20px;
            padding: 40px;
            box-shadow: 0 10px 40px rgba(0, 0, 0, 0.2);
        }

        .avatar-large {
            width: 120px;
            height: 120px;
            border-radius: 50%;
            border: 4px solid var(--gold);
            box-shadow: 0 5px 20px rgba(0, 0, 0, 0.2);
        }

        .discord-badge {
            background: linear-gradient(135deg, #43b581, #3ca374);
            color: white;
            padding: 8px 18px;
            border-radius: 20px;
            font-size: 0.9rem;
            font-weight: 600;
            display: inline-flex;
            align-items: center;
            gap: 8px;
            box-shadow: 0 2px 10px rgba(67, 181, 129, 0.4);
        }

        .stat-card {
            background: #f8f9fa;
            border-radius: 15px;
            padding: 20px;
            text-align: center;
            border-left: 4px solid var(--gold);
        }

        .activity-section {
            background: rgba(255, 255, 255, 0.95);
            border-radius: 20px;
            padding: 25px;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.1);
        }

        .activity-item-card {
            background: #fdfdfd;
            /* „Ç´„Éº„Éâ„ÅÆ‰∏≠„Å´„Ç´„Éº„Éâ„Åß„ÅÇ„Çã„Åì„Å®„ÇíÂº∑Ë™ø„Åô„Çã„Åü„ÇÅ„ÅÆÂæÆË™øÊï¥ */
            border-radius: 12px;
            padding: 18px;
            margin-bottom: 15px;
            border: 1px solid #eff0f1;
            transition: all 0.2s ease;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.03);
            display: block;
        }

        .activity-item-card:hover {
            transform: translateY(-3px);
            box-shadow: 0 8px 24px rgba(0, 0, 0, 0.08);
            border-color: var(--gold);
        }

        .activity-date {
            font-size: 0.85rem;
            color: #888;
            margin-bottom: 10px;
            display: block;
            border-bottom: 1px solid #f5f5f5;
            padding-bottom: 5px;
        }

        .activity-type-badge {
            font-size: 0.75rem;
            font-weight: 700;
            padding: 4px 12px;
            border-radius: 50px;
            background: #f0f2f5;
            color: #4b515d;
            box-shadow: inset 0 1px 3px rgba(0, 0, 0, 0.05);
        }

        .activity-details {
            font-size: 0.95rem;
            color: #2c3e50;
            font-weight: 500;
        }

        .activity-amount {
            font-family: 'Inter', 'Kosugi Maru', sans-serif;
            font-weight: 800;
            font-size: 1.15rem;
            letter-spacing: -0.02em;
        }

        .stat-value {
            font-size: 2rem;
            font-weight: 700;
            color: var(--deep-purple);
        }

        .stat-label {
            font-size: 0.9rem;
            color: #666;
        }

        /* È∫ªÈõÄÁµ±Ë®à„Éï„Ç£„É´„Çø„Éº */
        .mahjong-filter-group {
            display: flex;
            flex-direction: column;
            gap: 2px;
        }

        .filter-label-mini {
            font-size: 0.7rem;
            color: #888;
            font-weight: bold;
        }

        .mahjong-filter-select {
            padding: 6px 12px;
            border: 2px solid #d4a853;
            border-radius: 8px;
            background: linear-gradient(135deg, #fff9e6 0%, #fff 100%);
            color: #333;
            font-size: 0.85rem;
            font-weight: bold;
            cursor: pointer;
            min-width: 100px;
            transition: all 0.3s ease;
        }

        .mahjong-filter-select:hover {
            border-color: #c49743;
            box-shadow: 0 2px 8px rgba(212, 168, 83, 0.3);
        }

        .mahjong-filter-select:focus {
            outline: none;
            border-color: #b88533;
            box-shadow: 0 0 0 3px rgba(212, 168, 83, 0.2);
        }

        .login-prompt {
            text-align: center;
            padding: 60px 20px;
        }

        .login-prompt-btn {
            background: linear-gradient(135deg, #5865F2, #4752c4);
            color: white;
            padding: 15px 40px;
            border-radius: 12px;
            border: none;
            font-size: 1.1rem;
            cursor: pointer;
            display: inline-flex;
            align-items: center;
            gap: 10px;
            transition: all 0.3s ease;
        }

        .login-prompt-btn:hover {
            transform: translateY(-3px);
            box-shadow: 0 8px 25px rgba(88, 101, 242, 0.4);
        }

        .logout-btn {
            background: rgba(220, 53, 69, 0.1);
            color: #dc3545;
            border: 2px solid #dc3545;
            padding: 10px 25px;
            border-radius: 10px;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .logout-btn:hover {
            background: #dc3545;
            color: white;
        }

        /* „Éã„ÉÉ„ÇØ„Éç„Éº„É†ÂÖ•ÂäõÊ¨Ñ */
        .nickname-input {
            background: #fff;
            border: 2px solid #e0d8f0;
            border-radius: 12px;
            padding: 12px 16px;
            font-size: 1rem;
            transition: all 0.3s ease;
            color: #333;
        }

        .nickname-input::placeholder {
            color: #aaa;
            font-style: italic;
        }

        .nickname-input:focus {
            border-color: var(--primary-purple);
            box-shadow: 0 0 0 4px rgba(107, 91, 149, 0.15);
            outline: none;
            background: #fff;
        }

        /* „Ç¢„Ç§„Ç≥„É≥Êõ¥Êñ∞„Éú„Çø„É≥ */
        .btn-avatar-update {
            background: linear-gradient(135deg, #5865F2 0%, #4752c4 100%);
            color: white;
            border: none;
            border-radius: 20px;
            padding: 6px 14px;
            font-size: 0.75rem;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            box-shadow: 0 2px 8px rgba(88, 101, 242, 0.3);
        }

        .btn-avatar-update:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(88, 101, 242, 0.5);
            background: linear-gradient(135deg, #6872f4 0%, #5865F2 100%);
        }

        /* Áµ±Ë®à„Éü„Éã„Ç´„Éº„Éâ */
        .stat-card-mini {
            background: #fff;
            border-radius: 12px;
            padding: 15px;
            text-align: center;
            transition: all 0.3s ease;
            border: 1px solid #dee2e6;
            cursor: pointer;
            height: 100%;
        }

        .stat-card-mini:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
            border-color: var(--gold);
        }

        .stat-card-mini.rank-1 {
            background: linear-gradient(135deg, #fff7ad 0%, #ffa700 100%) !important;
            border-left: 8px solid #ffd700 !important;
            box-shadow: 0 4px 15px rgba(255, 215, 0, 0.3) !important;
        }

        .stat-card-mini.rank-2 {
            background: linear-gradient(135deg, #f0f0f0 0%, #a0a0a0 100%) !important;
            border-left: 8px solid #c0c0c0 !important;
            box-shadow: 0 4px 15px rgba(192, 192, 192, 0.3) !important;
        }

        .stat-card-mini.rank-3 {
            background: linear-gradient(135deg, #f5d4b5 0%, #b87333 100%) !important;
            border-left: 8px solid #cd7f32 !important;
            box-shadow: 0 4px 15px rgba(205, 127, 50, 0.3) !important;
        }

        .stat-label-mini {
            font-size: 0.75rem;
            color: #6c757d;
            font-weight: 600;
            margin-bottom: 5px;
        }

        .stat-value-mini {
            font-size: 1.3rem;
            font-weight: 700;
            color: var(--deep-purple);
        }

        .stat-rank {
            font-size: 0.7rem;
            color: #fff;
            background: linear-gradient(135deg, var(--gold), #b8860b);
            padding: 2px 8px;
            border-radius: 10px;
            margin-top: 5px;
            display: inline-block;
            border: 1px solid rgba(255, 255, 255, 0.5);
        }

        .stat-rank.no-data {
            background: #adb5bd;
        }

        @media (max-width: 767px) {
            .stat-card-mini {
                display: flex;
                align-items: center;
                justify-content: space-between;
                padding: 10px 15px;
                text-align: left;
            }

            .stat-label-mini {
                margin-bottom: 0;
                flex: 1;
            }

            .stat-value-mini {
                font-size: 1.1rem;
                margin: 0 10px;
                flex: 1;
                text-align: right;
            }

            .stat-rank {
                margin-top: 0;
                font-size: 0.65rem;
                min-width: 60px;
                text-align: center;
            }
        }

        /* „Éê„ÉÉ„Ç∏‰∏ÄË¶ß„ÅÆ„Çπ„Çø„Ç§„É´ */
        .badge-item {
            cursor: pointer;
            transition: all 0.2s;
            border: 3px solid transparent;
            border-radius: 12px;
            padding: 8px;
            background: #f8f9fa;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .badge-item:hover {
            transform: scale(1.05);
            background: #fff;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.1);
        }

        .badge-item.equipped {
            border-color: rgba(212, 165, 116, 0.4);
            background: #fff9e6;
        }

        .badge-item.selected {
            border-color: var(--gold) !important;
            background: #fff !important;
            box-shadow: 0 0 0 3px rgba(211, 168, 83, 0.5) !important;
            transform: scale(1.05);
        }

        .badge-item img {
            width: 70px;
            height: 70px;
            object-fit: contain;
            display: block;
        }

        .badge-count-overlay {
            position: absolute;
            bottom: -5px;
            right: -5px;
            background: #dc3545;
            color: white;
            font-size: 0.75rem;
            font-weight: bold;
            padding: 2px 6px;
            border-radius: 10px;
            border: 2px solid white;
            z-index: 10;
        }

        /* „É≠„Éº„Éá„Ç£„É≥„Ç∞„Ç™„Éº„Éê„Éº„É¨„Ç§ */
        .loading-overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(255, 255, 255, 0.7);
            display: flex;
            align-items: center;
            justify-content: center;
            z-index: 9999;
            visibility: hidden;
            opacity: 0;
            transition: all 0.3s;
        }

        .loading-overlay.active {
            visibility: visible;
            opacity: 1;
        }

        /* „É¶„Éº„Ç∂„ÉºÈÅ∏Êäû„É™„Çπ„Éà */
        .user-select-item {
            cursor: pointer;
            transition: background 0.2s;
            display: flex;
            align-items: center;
            padding: 12px 20px;
            border-bottom: 1px solid #eee;
        }

        .user-select-item:hover {
            background-color: #f8f9fa;
        }


        .user-select-avatar {
            width: 70px;
            height: 70px;
            border-radius: 50%;
            object-fit: cover;
            margin-right: 15px;
            border: 2px solid var(--gold);
        }

        .user-select-badge {
            width: 24px;
            height: 24px;
            object-fit: contain;
            margin-left: 8px;
        }

        .user-select-name {
            font-weight: 700;
            color: var(--deep-purple);
            font-size: 1rem;
        }

        /* „Éä„Éì„Ç≤„Éº„Ç∑„Éß„É≥„Éâ„É≠„ÉÉ„Éó„ÉÄ„Ç¶„É≥ */
        .nav-dropdown {
            position: fixed;
            top: 20px;
            right: 20px;
            z-index: 1000;
        }

        .record-button {
            background: linear-gradient(135deg, var(--gold) 0%, #b8892d 100%);
            color: white;
            padding: 12px 24px;
            border-radius: 25px;
            font-weight: bold;
            font-size: 1.1rem;
            box-shadow: 0 6px 20px rgba(212, 168, 83, 0.5);
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            gap: 8px;
            border: none;
            cursor: pointer;
        }

        .record-button:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 20px rgba(212, 168, 83, 0.6);
            color: white;
        }

        .nav-dropdown-menu {
            background: white;
            border-radius: 12px;
            box-shadow: 0 8px 30px rgba(0, 0, 0, 0.2);
            min-width: 200px;
            overflow: hidden;
        }

        .nav-dropdown-menu .dropdown-item {
            padding: 12px 20px;
            display: flex;
            align-items: center;
            gap: 10px;
            color: #333;
            transition: background 0.2s;
        }

        .nav-dropdown-menu .dropdown-item:hover {
            background: #f5f5f5;
        }

        .nav-dropdown-menu .dropdown-divider {
            margin: 0;
        }

        .notification-badge {
            background: #dc3545;
            color: white;
            font-size: 0.7rem;
            padding: 2px 6px;
            border-radius: 10px;
            margin-left: auto;
        }

        /* „É¨„Ç¢„É™„ÉÜ„Ç£Âà•ËÉåÊôØËâ≤ */
        .rarity-wood {
            background: #d7ccc8 !important;
            color: #5d4037 !important;
            border-color: #8d6e63 !important;
        }

        .rarity-stone {
            background: #cfd8dc !important;
            color: #455a64 !important;
            border-color: #90a4ae !important;
        }

        .rarity-bronze {
            background: #ffe0b2 !important;
            color: #e65100 !important;
            border-color: #ffb74d !important;
        }

        .rarity-silver {
            background: #f5f5f5 !important;
            color: #616161 !important;
            border-color: #bdbdbd !important;
        }

        .rarity-gold {
            background: linear-gradient(135deg, #fff9c4 0%, #fbc02d 100%) !important;
            color: #f57f17 !important;
            border-color: #fdd835 !important;
        }

        .rarity-platinum {
            background: linear-gradient(135deg, #e1f5fe 0%, #b3e5fc 100%) !important;
            color: #0277bd !important;
            border-color: #4fc3f7 !important;
        }

        .rarity-gem {
            background: linear-gradient(135deg, #f3e5f5 0%, #ce93d8 100%) !important;
            color: #7b1fa2 !important;
            border-color: #ba68c8 !important;
            box-shadow: 0 0 15px rgba(186, 104, 200, 0.4);
        }

        .rarity-legend {
            background: linear-gradient(135deg, #fff9c4 0%, #fbc02d 50%, #f9a825 100%) !important;
            color: #f57f17 !important;
            border-color: #ffd700 !important;
            box-shadow: 0 0 20px rgba(255, 215, 0, 0.5);
        }

        .rarity-fantasy {
            background: linear-gradient(135deg, #e1f5fe 0%, #81d4fa 50%, #4fc3f7 100%) !important;
            color: #01579b !important;
            border-color: #00bcd4 !important;
            box-shadow: 0 0 25px rgba(0, 188, 212, 0.5);
        }

        .rarity-supreme {
            background: linear-gradient(135deg, #fce4ec 0%, #f06292 50%, #e91e63 100%) !important;
            color: #880e4f !important;
            border-color: #ff4081 !important;
            box-shadow: 0 0 30px rgba(255, 64, 129, 0.6);
        }

        .rarity-mythic {
            background: linear-gradient(135deg, #fffde7 0%, #fff176 50%, #ffd600 100%) !important;
            color: #f57f17 !important;
            border-color: #ffea00 !important;
            box-shadow: 0 0 40px rgba(255, 234, 0, 0.7);
        }

        .rarity-void {
            background: #000 !important;
            color: #fff !important;
            border-color: #333 !important;
        }





        /* „Éó„É¨„Éü„Ç¢„É†„Éª„Éö„Éº„Ç∏„Éç„Éº„Ç∑„Éß„É≥ */
        .pagination-premium .page-link {
            border: none;
            margin: 0 4px;
            border-radius: 8px !important;
            color: var(--deep-purple);
            background: rgba(255, 255, 255, 0.8);
            transition: all 0.3s ease;
            width: 36px;
            height: 36px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: bold;
            box-shadow: 0 2px 5px rgba(0, 0, 0, 0.05);
        }

        .pagination-premium .page-item.active .page-link {
            background: linear-gradient(135deg, var(--deep-purple), var(--soft-purple));
            color: white !important;
            box-shadow: 0 4px 10px rgba(106, 17, 203, 0.3);
        }

        /* „Éê„ÉÉ„Ç∏„Ç¢„ÇØ„Ç∑„Éß„É≥„Éú„Çø„É≥ÔºàÊîπÂñÑ„Éá„Ç∂„Ç§„É≥Ôºâ */
        .btn-badge-action {
            display: inline-flex;
            align-items: center;
            gap: 6px;
            padding: 8px 16px;
            border-radius: 20px;
            font-size: 0.9rem;
            font-weight: 600;
            border: 2px solid;
            transition: all 0.3s ease;
            cursor: pointer;
        }

        .btn-badge-action i {
            font-size: 1.1rem;
        }

        .btn-badge-transfer {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            border-color: #667eea;
            color: white;
        }

        .btn-badge-transfer:hover {
            background: linear-gradient(135deg, #764ba2 0%, #667eea 100%);
            border-color: #764ba2;
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(102, 126, 234, 0.4);
            color: white;
        }

        .btn-badge-sell {
            background: linear-gradient(135deg, #f093fb 0%, #f5576c 100%);
            border-color: #f5576c;
            color: white;
        }

        .btn-badge-sell:hover {
            background: linear-gradient(135deg, #f5576c 0%, #f093fb 100%);
            border-color: #f093fb;
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(245, 87, 108, 0.4);
            color: white;
        }

        .btn-badge-equip {
            background: linear-gradient(135deg, #ffeaa7 0%, #fdcb6e 100%);
            border-color: #fdcb6e;
            color: #2d3436;
        }

        .btn-badge-equip:hover {
            background: linear-gradient(135deg, #fdcb6e 0%, #ffeaa7 100%);
            border-color: #fdcb6e;
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(253, 203, 110, 0.4);
        }

        /* „Çª„ÇØ„Ç∑„Éß„É≥„Éò„ÉÉ„ÉÄ„Éº */
        .badge-section-header {
            cursor: pointer;
            padding: 8px 0;
            transition: all 0.2s;
            user-select: none;
        }

        .badge-section-header:hover {
            background: rgba(0, 0, 0, 0.02);
            border-radius: 8px;
            padding-left: 8px;
        }

        /* „Éê„ÉÉ„Ç∏„Ç≥„É≥„Éà„É≠„Éº„É´„Éë„Éç„É´ */
        .badge-control-panel {
            background: linear-gradient(135deg, #f8f9fa 0%, #e9ecef 100%);
            border-radius: 12px;
            padding: 15px;
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.05);
        }

        .badge-control-panel .form-control,
        .badge-control-panel .form-select {
            border: 2px solid #dee2e6;
            border-radius: 8px;
            padding: 8px 12px;
            font-size: 0.9rem;
            transition: all 0.3s ease;
            background: white;
        }

        .badge-control-panel .form-control:focus,
        .badge-control-panel .form-select:focus {
            border-color: var(--deep-purple);
            box-shadow: 0 0 0 3px rgba(106, 17, 203, 0.1);
            outline: none;
        }

        /* „Éü„É•„Éº„Çø„É≥„Éà„Éï„Ç£„É´„Çø„Éº„Éú„Çø„É≥ */
        .btn-mutant-filter {
            background: white;
            border: 2px solid #dee2e6;
            color: #333;
            font-weight: 600;
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
            border-radius: 8px;
            white-space: nowrap;
        }

        .btn-mutant-filter:hover {
            border-color: var(--deep-purple);
            background: rgba(106, 17, 203, 0.05);
            transform: translateY(-1px);
        }

        .btn-mutant-filter.active {
            background: linear-gradient(135deg, #FFD700 0%, #FFA500 100%) !important;
            color: #2d3436 !important;
            border-color: transparent !important;
            box-shadow: 0 4px 15px rgba(255, 165, 0, 0.4);
            transform: scale(1.02);
        }

        .btn-mutant-filter.active::before {
            content: "‚≠ê ";
        }

        /* „Éö„Éº„Ç∏„Éç„Éº„Ç∑„Éß„É≥„ÅÆ„Éó„É¨„Éü„Ç¢„É†„Çπ„Çø„Ç§„É´ */
        .pagination-premium {
            display: flex;
            flex-wrap: wrap;
            justify-content: center;
            gap: 4px;
            margin-bottom: 0;
            padding: 0;
            list-style: none;
        }

        .pagination-premium .page-item {
            margin: 0 !important;
        }

        .pagination-premium .page-link {
            border: none;
            background: white;
            color: var(--deep-purple);
            border-radius: 8px !important;
            min-width: 32px;
            height: 32px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 0.85rem;
            transition: all 0.2s;
            box-shadow: 0 2px 5px rgba(0, 0, 0, 0.05);
        }

        .pagination-premium .page-item.active .page-link {
            background: var(--primary-gradient) !important;
            color: white !important;
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.15);
        }

        .pagination-premium .page-item.disabled .page-link {
            opacity: 0.5;
            pointer-events: none;
        }

        @media (max-width: 576px) {
            .pagination-premium {
                gap: 2px;
            }

            .pagination-premium .page-link {
                min-width: 28px;
                height: 28px;
                font-size: 0.75rem;
            }
        }

        /* „É¨„Çπ„Éù„É≥„Ç∑„ÉñË™øÊï¥ */
        @media (max-width: 767px) {
            .badge-control-panel {
                padding: 12px;
            }

            .badge-control-panel .form-control,
            .badge-control-panel .form-select,
            .badge-control-panel .form-check {
                font-size: 0.85rem;
            }
        }

        /* „Éï„Ç£„É´„Çø„Éº„Ç≥„É≥„Éà„É≠„Éº„É´„Éë„Éç„É´ */
        .badge-control-panel {
            background: #f8f9fa;
            border-radius: 12px;
            padding: 15px;
            border: 1px solid #e9ecef;
        }

        /* „É¢„Éê„Ç§„É´ÂØæÂøú„ÅÆ„Ç∞„É™„ÉÉ„Éâ */
        @media (max-width: 767px) {

            /* „Éê„ÉÉ„Ç∏„Ç≥„É¨„ÇØ„Ç∑„Éß„É≥„ÅÆ„Ç∞„É™„ÉÉ„Éâ: 2ÂàóÂõ∫ÂÆö */
            #special-badge-list>div,
            #convertible-badge-list>div,
            #purchasable-badge-list>div {
                flex: 0 0 50% !important;
                max-width: 50% !important;
            }

            /* „Éú„Çø„É≥„ÇíÁ∏¶‰∏¶„Å≥„Å´ */
            .btn-badge-action {
                flex: 1;
                min-width: 0;
                justify-content: center;
            }

            /* „Éï„Ç£„É´„Çø„Éº„Ç≥„É≥„Éà„É≠„Éº„É´„Çí„É¢„Éê„Ç§„É´ÊúÄÈÅ©Âåñ */
            .badge-control-panel .row>div {
                margin-bottom: 8px;
            }

            .badge-control-panel select,
            .badge-control-panel input {
                font-size: 0.85rem;
            }
        }

        /* PCÁâà„Åß„ÅØ4Âàó */
        @media (min-width: 768px) {
            #purchasable-badge-list>div {
                flex: 0 0 25% !important;
                max-width: 25% !important;
            }
        }
    </style>
</head>

<body>
    <!-- Âè≥‰∏ä„ÅÆ„Éä„Éì„Ç≤„Éº„Ç∑„Éß„É≥„Éâ„É≠„ÉÉ„Éó„ÉÄ„Ç¶„É≥ -->
    <div class="nav-dropdown dropdown">
        <button class="record-button dropdown-toggle" type="button" id="navDropdown" data-bs-toggle="dropdown"
            aria-expanded="false">
            üìù „É°„Éã„É•„Éº
        </button>
        <ul class="dropdown-menu nav-dropdown-menu dropdown-menu-end" aria-labelledby="navDropdown">
            <li><a class="dropdown-item" href="../index.html">üè† „Éõ„Éº„É†„Å´Êàª„Çã</a></li>
            <li><a class="dropdown-item" href="./index.html">üë§ „Éû„Ç§„Éö„Éº„Ç∏</a></li>
            <li>
                <hr class="dropdown-divider">
            </li>
            <li><a class="dropdown-item" href="../mahjong/index.html">üìä „É©„É≥„Ç≠„É≥„Ç∞</a></li>
            <li><a class="dropdown-item" href="../mahjong/record.html">üìù Ë®òÈå≤„Åô„Çã</a></li>
            <li><a class="dropdown-item" href="../mahjong/users/index.html">üë• „É¶„Éº„Ç∂„Éº‰∏ÄË¶ß</a></li>
            <li><a class="dropdown-item" href="../mahjong/team/index.html">üèÖ „ÉÅ„Éº„É†ÁÆ°ÁêÜ <span id="team-notification-badge"
                        class="notification-badge" style="display:none;">0</span></a></li>
            <li><a class="dropdown-item" href="../badge/list.html">üìõ „Éê„ÉÉ„Ç∏‰∏ÄË¶ß</a></li>
            <li><a class="dropdown-item" href="../badge/shop.html">üõí „Éê„ÉÉ„Ç∏„Ç∑„Éß„ÉÉ„Éó</a></li>
            <li><a class="dropdown-item" href="../ranking/index.html">üí∞ Ë≥áÁî£„É©„É≥„Ç≠„É≥„Ç∞</a></li>
            <li class="admin-only" style="display:none;"><a class="dropdown-item" href="../omikuji/index.html">üéã
                    „Åä„Åø„Åè„Åò</a></li>
            <li class="admin-only" style="display:none;">
                <hr class="dropdown-divider">
            </li>
            <li class="admin-only" style="display:none;">
                <a class="dropdown-item" href="../admin/index.html">‚öôÔ∏è ÁÆ°ÁêÜÁîªÈù¢</a>
            </li>
        </ul>
    </div>

    <div class="container py-5">
        <!-- Êàª„Çã„Éú„Çø„É≥ -->
        <div class="mb-4">
            <a href="#" onclick="goBack(); return false;" class="back-button">
                ‚Üê Êàª„Çã
            </a>
        </div>


        <!-- „Éò„ÉÉ„ÉÄ„Éº -->
        <header class="text-center mb-5">
            <h1 class="page-header display-4 fw-bold mb-3">üë§ „Éû„Ç§„Éö„Éº„Ç∏</h1>
        </header>

        <!-- „Ç≥„É≥„ÉÜ„É≥„ÉÑ -->
        <div class="row justify-content-center">
            <div class="col-12 col-lg-10">

                <!-- Êú™„É≠„Ç∞„Ç§„É≥ÊôÇ -->
                <div id="login-prompt" class="profile-card login-prompt" style="display: none;">
                    <h3 class="mb-4" style="font-family: var(--font-title); color: var(--deep-purple);">
                        „É≠„Ç∞„Ç§„É≥„Åó„Å¶„Åè„Å†„Åï„ÅÑ
                    </h3>
                    <p class="text-muted mb-4">
                        „Éû„Ç§„Éö„Éº„Ç∏„ÇíË°®Á§∫„Åô„Çã„Å´„ÅØDiscord„Åß„É≠„Ç∞„Ç§„É≥„ÅåÂøÖË¶Å„Åß„Åô„ÄÇ
                    </p>
                    <button onclick="loginWithDiscord()" class="login-prompt-btn">
                        <img src="https://assets-global.website-files.com/6257adef93867e50d84d30e2/636e0a69f118df70ad7828d4_icon_clyde_blurple_RGB.svg"
                            alt="Discord" style="width: 24px;">
                        Discord„Åß„É≠„Ç∞„Ç§„É≥
                    </button>
                </div>

                <!-- „É≠„Ç∞„Ç§„É≥Ê∏à„ÅøÔºà„Åæ„Åü„ÅØÈñ≤Ë¶ß„É¢„Éº„ÉâÔºâ -->
                <div id="profile-content" style="display: none;">
                    <div class="profile-card mb-4">
                        <!-- ‰∏äÊÆµ: „Éê„ÉÉ„Ç∏ + ÂêçÂâç + „Éê„ÉÉ„Ç∏ + Á∑®ÈõÜ„Éú„Çø„É≥ -->
                        <div class="d-flex align-items-center justify-content-between mb-3">
                            <div class="d-flex align-items-center gap-2 flex-grow-1" style="min-width: 0;">
                                <div id="badge-container-left" class="mutant-badge-container">
                                    <img id="user-equipped-badge" src="" alt=""
                                        style="width: 36px; height: 36px; border-radius: 8px; display: none;" title="">
                                    <div class="mutant-badge-shine" style="display: none;"></div>
                                </div>
                                <h2 id="user-name" class="mb-0 text-truncate"
                                    style="font-family: var(--font-title); color: var(--deep-purple); font-size: 1.4rem; text-transform: none !important;">
                                    „É¶„Éº„Ç∂„ÉºÂêç
                                </h2>
                                <div id="badge-container-right" class="mutant-badge-container">
                                    <img id="user-equipped-badge-right" src="" alt=""
                                        style="width: 36px; height: 36px; border-radius: 8px; display: none;" title="">
                                    <div class="mutant-badge-shine" style="display: none;"></div>
                                </div>
                            </div>
                            <button id="nickname-edit-btn" onclick="openNicknameModal()"
                                class="btn btn-sm btn-outline-secondary flex-shrink-0" title="„Éã„ÉÉ„ÇØ„Éç„Éº„É†„ÇíÂ§âÊõ¥"
                                style="display: none; padding: 4px 10px;">
                                ‚úèÔ∏è
                            </button>
                        </div>

                        <!-- ‰∏ãÊÆµ: „Ç¢„Éê„Çø„Éº + ÊÉÖÂ†± -->
                        <div class="row align-items-start">
                            <div class="col-auto">
                                <div class="text-center">
                                    <img id="user-avatar" src="" alt="„Ç¢„Éê„Çø„Éº" class="avatar-large">
                                    <button id="sync-btn" onclick="updateAvatar()"
                                        class="btn btn-sm btn-outline-secondary mt-2" title="Discord„Åã„ÇâÊúÄÊñ∞„ÅÆ„Ç¢„Éê„Çø„ÉºÁîªÂÉè„ÇíÂèñÂæó"
                                        style="font-size: 0.7rem; padding: 3px 8px;">
                                        üîÑ ÂêåÊúü
                                    </button>
                                </div>
                            </div>
                            <div class="col">
                                <!-- Removed Player label -->
                                <h2 id="page-title-label" class="small text-muted mb-1" style="display:none;"></h2>

                                <!-- „ÉÅ„Éº„É†Âêç -->
                                <div id="user-team-display" class="mb-2">
                                    <span class="badge bg-secondary" style="font-size: 0.85rem;">
                                        üè† <span id="user-team-name">Êú™ÊâÄÂ±û</span>
                                    </span>
                                </div>

                                <!-- ÊâÄÊåÅÈáë -->
                                <div id="user-coins-display" class="mb-2"
                                    style="display: none; flex-wrap: wrap; gap: 8px; align-items: center;">
                                    <span class="badge bg-light text-dark shadow-sm"
                                        style="font-size: 0.85rem; border: 1px solid var(--gold); padding: 6px 12px;">
                                        ÊâÄÊåÅÈáë: ü™ô <span id="user-coins-value">0</span>
                                    </span>
                                    <span class="badge bg-light text-dark shadow-sm"
                                        style="font-size: 0.85rem; border: 1px solid #17a2b8; padding: 6px 12px;">
                                        Á∑èË≥áÁî£: üìä <span id="total-assets-value">0</span>
                                    </span>
                                    <span class="badge bg-light text-dark shadow-sm"
                                        style="font-size: 0.85rem; border: 1px solid #ffc107; padding: 6px 12px;">
                                        Á•àÈ°òÁ¨¶: üßß <span id="user-tickets-value">0</span>
                                    </span>
                                    <div class="d-flex gap-2">
                                        <button id="coin-transfer-btn" onclick="openCoinTransferModal()"
                                            class="btn btn-sm btn-outline-primary"
                                            style="display: none; padding: 2px 8px; font-size: 0.75rem;">
                                            üí∏ ÈÄÅÈáë
                                        </button>
                                        <button id="possessions-btn" onclick="openPossessionsModal()"
                                            class="btn btn-sm btn-outline-warning"
                                            style="display: none; padding: 2px 8px; font-size: 0.75rem;">
                                            üéÅ ÊâÄÊåÅÂìÅ
                                        </button>
                                    </div>
                                </div>

                                <!-- Removed view-area with Mahjong Player label -->
                            </div>
                        </div>
                    </div>

                    <!-- È∫ªÈõÄÁµ±Ë®à -->
                    <div class="profile-card mb-4">
                        <div class="d-flex justify-content-between align-items-center mb-3 flex-wrap gap-2">
                            <h4 style="font-family: var(--font-title); color: var(--deep-purple); margin: 0;">
                                üÄÑ È∫ªÈõÄÁµ±Ë®à
                            </h4>
                            <div class="d-flex gap-2 flex-wrap">
                                <div class="mahjong-filter-group">
                                    <label class="filter-label-mini">üèÜ Â§ß‰ºö</label>
                                    <select id="tournament-select" class="mahjong-filter-select"
                                        onchange="handleTournamentChange()">
                                        <!-- JS„ÅßÁîüÊàê -->
                                    </select>
                                </div>
                                <div class="mahjong-filter-group">
                                    <label class="filter-label-mini">üÄÑ ÂΩ¢Âºè</label>
                                    <select id="mode-select" class="mahjong-filter-select"
                                        onchange="handleModeChange()">
                                        <option value="individual_yonma" selected>ÂÄã‰∫∫Êà¶ÔºàÂõõÈ∫ªÔºâ</option>
                                        <option value="individual_sanma">ÂÄã‰∫∫Êà¶Ôºà‰∏âÈ∫ªÔºâ</option>
                                        <option value="team">„ÉÅ„Éº„É†Êà¶</option>
                                    </select>
                                </div>
                            </div>
                        </div>

                        <div id="stats-loading" class="text-center py-4">
                            <div class="spinner-border text-primary" role="status">
                                <span class="visually-hidden">Ë™≠„ÅøËæº„Åø‰∏≠...</span>
                            </div>
                        </div>

                        <div id="stats-content" style="display: none;">
                            <div id="stats-grid">
                                <!-- Row 1: ÂêàË®à„Çπ„Ç≥„Ç¢„ÄÄÂπ≥Âùá„Çπ„Ç≥„Ç¢„ÄÄÊúÄÂ§ß„Çπ„Ç≥„Ç¢ -->
                                <div class="row g-3 mb-3">
                                    <div class="col-12 col-md-4">
                                        <div class="stat-card-mini" onclick="redirectToRanking('all')">
                                            <div class="stat-label-mini">ÂêàË®à„Çπ„Ç≥„Ç¢</div>
                                            <div class="stat-value-mini" id="stat-total">-</div>
                                            <div class="stat-rank" id="rank-total">-</div>
                                        </div>
                                    </div>
                                    <div class="col-12 col-md-4">
                                        <div class="stat-card-mini" onclick="redirectToRanking('avg_score')">
                                            <div class="stat-label-mini">Âπ≥Âùá„Çπ„Ç≥„Ç¢</div>
                                            <div class="stat-value-mini" id="stat-avg-score">-</div>
                                            <div class="stat-rank" id="rank-avg-score">-</div>
                                        </div>
                                    </div>
                                    <div class="col-12 col-md-4">
                                        <div class="stat-card-mini" onclick="redirectToRanking('max_score')">
                                            <div class="stat-label-mini">ÊúÄÂ§ß„Çπ„Ç≥„Ç¢</div>
                                            <div class="stat-value-mini" id="stat-max-score">-</div>
                                            <div class="stat-rank" id="rank-max-score">-</div>
                                        </div>
                                    </div>
                                </div>

                                <!-- Row 2: Âíå‰∫ÜÁéá„ÄÄÊîæÈäÉÁéá„ÄÄ„Éê„É©„É≥„ÇπÈõÄÂäõ -->
                                <div class="row g-3 mb-3">
                                    <div class="col-12 col-md-4">
                                        <div class="stat-card-mini" onclick="redirectToRanking('win')">
                                            <div class="stat-label-mini">Âíå‰∫ÜÁéá</div>
                                            <div class="stat-value-mini" id="stat-win-rate">-</div>
                                            <div class="stat-rank" id="rank-win-rate">-</div>
                                        </div>
                                    </div>
                                    <div class="col-12 col-md-4">
                                        <div class="stat-card-mini" onclick="redirectToRanking('deal')">
                                            <div class="stat-label-mini">ÊîæÈäÉÁéá</div>
                                            <div class="stat-value-mini" id="stat-deal-rate">-</div>
                                            <div class="stat-rank" id="rank-deal-rate">-</div>
                                        </div>
                                    </div>
                                    <div class="col-12 col-md-4">
                                        <div class="stat-card-mini" onclick="redirectToRanking('skill')">
                                            <div class="stat-label-mini">„Éê„É©„É≥„ÇπÈõÄÂäõ</div>
                                            <div class="stat-value-mini" id="stat-skill">-</div>
                                            <div class="stat-rank" id="rank-skill">-</div>
                                        </div>
                                    </div>
                                </div>

                                <!-- Row 3: Âπ≥ÂùáÈ†Ü‰Ωç„ÄÄ„Éà„ÉÉ„ÉóÁéá„ÄÄ„É©„ÇπÂõûÈÅøÁéá -->
                                <div class="row g-3 mb-3">
                                    <div class="col-12 col-md-4">
                                        <div class="stat-card-mini" onclick="redirectToRanking('avg_rank')">
                                            <div class="stat-label-mini">Âπ≥ÂùáÈ†Ü‰Ωç</div>
                                            <div class="stat-value-mini" id="stat-avg-rank">-</div>
                                            <div class="stat-rank" id="rank-avg-rank">-</div>
                                        </div>
                                    </div>
                                    <div class="col-12 col-md-4">
                                        <div class="stat-card-mini" onclick="redirectToRanking('top')">
                                            <div class="stat-label-mini">„Éà„ÉÉ„ÉóÁéá</div>
                                            <div class="stat-value-mini" id="stat-top-rate">-</div>
                                            <div class="stat-rank" id="rank-top-rate">-</div>
                                        </div>
                                    </div>
                                    <div class="col-12 col-md-4">
                                        <div class="stat-card-mini" onclick="redirectToRanking('avoid')">
                                            <div class="stat-label-mini">„É©„ÇπÂõûÈÅøÁéá</div>
                                            <div class="stat-value-mini" id="stat-avoid-rate">-</div>
                                            <div class="stat-rank" id="rank-avoid-rate">-</div>
                                        </div>
                                    </div>
                                </div>

                                <!-- Row 4: Ë©¶ÂêàÊï∞„ÄÄÂ±ÄÊï∞„ÄÄ„É¨„Éº„ÉÜ„Ç£„É≥„Ç∞ -->
                                <div class="row g-3">
                                    <div class="col-12 col-md-4">
                                        <div class="stat-card-mini" onclick="redirectToRanking('match_count')">
                                            <div class="stat-label-mini">Ë©¶ÂêàÊï∞</div>
                                            <div class="stat-value-mini" id="stat-games">-</div>
                                            <div class="stat-rank" id="rank-games">-</div>
                                        </div>
                                    </div>
                                    <div class="col-12 col-md-4">
                                        <div class="stat-card-mini" style="cursor: default;">
                                            <div class="stat-label-mini">Â±ÄÊï∞</div>
                                            <div class="stat-value-mini" id="stat-hands">-</div>
                                        </div>
                                    </div>
                                    <div class="col-12 col-md-4">
                                        <div class="stat-card-mini"
                                            style="background: linear-gradient(135deg, #f3e5f5, #fff); cursor: default;">
                                            <div class="stat-label-mini">üìä „É¨„Éº„ÉÜ„Ç£„É≥„Ç∞</div>
                                            <div class="stat-value-mini" id="stat-rating">-</div>
                                        </div>
                                    </div>
                                </div>

                                <!-- ÂØæÊà¶Áõ∏ÊâãÁµ±Ë®à -->
                                <div id="opponent-stats-section" class="mt-4 pt-3"
                                    style="border-top: 1px solid #eee; display: none;">
                                    <h6 class="text-muted mb-3" style="font-size: 1.1rem; font-weight: bold;">üéØ ÂØæÊà¶Áõ∏ÊâãÁµ±Ë®à
                                    </h6>

                                    <!-- ÂØæÊà¶ÂõûÊï∞„Éà„ÉÉ„Éó3 -->
                                    <div class="mb-3">
                                        <div class="small text-muted mb-2">„Çà„ÅèÂØæÊà¶„Åô„Çã„Éó„É¨„Ç§„É§„Éº</div>
                                        <div id="top-opponents-list" class="d-flex flex-wrap gap-2">
                                            <!-- JS„ÅßÁîüÊàê -->
                                        </div>
                                    </div>

                                    <!-- Áõ∏ÊÄßÁµ±Ë®à -->
                                    <div class="row g-2">
                                        <div class="col-12 col-md-6">
                                            <div class="p-2 rounded mb-1"
                                                style="background: linear-gradient(135deg, #e8f5e9, #fff); border: 1px solid #c8e6c9;">
                                                <div class="small text-muted mb-1">üî• ‰∏ÄÁï™Âãù„Å°Ë∂ä„Åó</div>
                                                <div id="best-matchup" class="d-flex align-items-center gap-2">
                                                    <span class="text-muted small">-</span>
                                                </div>
                                            </div>
                                        </div>
                                        <div class="col-12 col-md-6">
                                            <div class="p-2 rounded"
                                                style="background: linear-gradient(135deg, #ffebee, #fff); border: 1px solid #ffcdd2;">
                                                <div class="small text-muted mb-1">üíî ‰∏ÄÁï™Ë≤†„ÅëË∂ä„Åó</div>
                                                <div id="worst-matchup" class="d-flex align-items-center gap-2">
                                                    <span class="text-muted small">-</span>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>

                            <div id="no-stats-msg" class="text-center text-muted py-3" style="display: none;">
                                „Åæ„Å†È∫ªÈõÄÂ§ß‰ºö„Å´ÂèÇÂä†„Åó„Å¶„ÅÑ„Åæ„Åõ„Çì
                            </div>
                        </div>
                    </div>

                    <!-- „Éê„ÉÉ„Ç∏„Ç≥„É¨„ÇØ„Ç∑„Éß„É≥ -->
                    <div class="profile-card mb-4" id="badge-collection-section" style="display: none;">
                        <!-- „Çø„Ç§„Éà„É´Ë°å -->
                        <div class="d-flex justify-content-between align-items-center mb-3 flex-wrap gap-2">
                            <h4 style="font-family: var(--font-title); color: var(--deep-purple); margin: 0;">
                                üìõ „Éê„ÉÉ„Ç∏„Ç≥„É¨„ÇØ„Ç∑„Éß„É≥
                            </h4>
                            <div class="d-flex gap-2" id="badge-header-actions">
                                <button id="badge-change-btn" onclick="openBadgeChangeModal()"
                                    class="btn-badge-action btn-badge-equip" style="display: none;">
                                    <i class="bi bi-award"></i>
                                    <span>Ë£ÖÁùÄ</span>
                                </button>
                                <button id="badge-transfer-btn" onclick="openInventoryModalFor('transfer')"
                                    class="btn-badge-action btn-badge-transfer" style="display: none;">
                                    <i class="bi bi-gift"></i>
                                    <span>Ë≠≤Ê∏°</span>
                                </button>
                                <button id="badge-sell-btn" onclick="openInventoryModalFor('sell')"
                                    class="btn-badge-action btn-badge-sell" style="display: none;">
                                    <i class="bi bi-cash-coin"></i>
                                    <span>Â£≤Âç¥</span>
                                </button>
                            </div>
                        </div>

                        <!-- ÈôêÂÆö„Éê„ÉÉ„Ç∏ÔºàÊäò„ÇäÁï≥„ÅøÔºâ -->
                        <div id="special-badges-section" class="mb-3" style="display: none;">
                            <div class="d-flex justify-content-between align-items-center mb-2 badge-section-header"
                                onclick="toggleBadgeSection('special')" style="cursor: pointer;">
                                <h6 class="text-muted mb-0" style="font-size: 0.9rem;">
                                    <span id="special-toggle-icon">‚ñ∂</span> üèÜ ÈôêÂÆö„Éê„ÉÉ„Ç∏
                                    <span id="special-count" class="badge bg-secondary ms-2">0</span>
                                </h6>
                            </div>
                            <div id="special-badge-content" style="display: none;">
                                <div id="special-badge-list" class="row g-3 mb-4">
                                    <!-- JS„ÅßÁîüÊàê -->
                                </div>
                            </div>
                        </div>

                        <!-- ÊèõÈáëÂìÅÔºàÊäò„ÇäÁï≥„ÅøÔºâ -->
                        <div id="convertible-badges-section" class="mb-3" style="display: none;">
                            <div class="d-flex justify-content-between align-items-center mb-2 badge-section-header"
                                onclick="toggleBadgeSection('convertible')" style="cursor: pointer;">
                                <h6 class="text-muted mb-0" style="font-size: 0.9rem;">
                                    <span id="convertible-toggle-icon">‚ñ∂</span> üíé ÊèõÈáëÂìÅ
                                    <span id="convertible-count" class="badge bg-secondary ms-2">0</span>
                                </h6>
                            </div>
                            <div id="convertible-badge-content" style="display: none;">
                                <div id="convertible-badge-list" class="row g-3 mb-4">
                                    <!-- JS„ÅßÁîüÊàê -->
                                </div>
                            </div>
                        </div>

                        <!-- Ë≥ºÂÖ•„Éê„ÉÉ„Ç∏ -->
                        <div id="purchasable-badges-section" style="display: none;">
                            <h6 class="text-muted mb-3" style="font-size: 0.9rem;">üõí Ë≥ºÂÖ•„Éê„ÉÉ„Ç∏</h6>

                            <!-- „Éï„Ç£„É´„Çø„ÉºÔºÜ„ÇΩ„Éº„ÉàUI -->
                            <div class="badge-control-panel mb-3">
                                <div class="row g-2">
                                    <!-- Ê§úÁ¥¢„Éê„Éº -->
                                    <div class="col-12 col-md-3">
                                        <div class="position-relative">
                                            <i class="bi bi-search"
                                                style="position: absolute; left: 12px; top: 50%; transform: translateY(-50%); color: #aaa;"></i>
                                            <input type="text" id="badge-search" class="form-control form-control-sm"
                                                style="padding-left: 35px;" placeholder="„Éê„ÉÉ„Ç∏Âêç„ÅßÊ§úÁ¥¢..."
                                                oninput="filterAndRenderBadges()">
                                        </div>
                                    </div>

                                    <!-- „ÇΩ„Éº„Éà -->
                                    <div class="col-6 col-md-3">
                                        <select id="badge-sort" class="form-select form-select-sm h-100"
                                            onchange="filterAndRenderBadges()">
                                            <option value="acquired_desc" selected>ÂÖ•ÊâãÈ†ÜÔºàÊñ∞‚ÜíÂè§Ôºâ</option>
                                            <option value="acquired_asc">ÂÖ•ÊâãÈ†ÜÔºàÂè§‚ÜíÊñ∞Ôºâ</option>
                                            <option value="number">„Éä„É≥„Éê„ÉºÈ†Ü</option>
                                            <option value="price_desc">‰æ°Ê†ºÈ†ÜÔºàÈ´ò‚Üí‰ΩéÔºâ</option>
                                            <option value="price_asc">‰æ°Ê†ºÈ†ÜÔºà‰Ωé‚ÜíÈ´òÔºâ</option>
                                            <option value="count">ÊâÄÊåÅÊï∞</option>
                                            <option value="circulation">ÊµÅÈÄöÊï∞</option>
                                        </select>
                                    </div>

                                    <!-- ÂΩ¢Âºè„Éï„Ç£„É´„Çø„Éº -->
                                    <div class="col-6 col-md-3">
                                        <select id="badge-type-filter" class="form-select form-select-sm h-100"
                                            onchange="filterAndRenderBadges()">
                                            <option value="">ÂΩ¢Âºè: „Åô„Åπ„Å¶</option>
                                            <option value="Â§âÂãïÂûã">Â§âÂãïÂûã</option>
                                            <option value="Âõ∫ÂÆöÂûã">Âõ∫ÂÆöÂûã</option>
                                            <option value="„Ç¨„ÉÅ„É£ÈôêÂÆö">„Ç¨„ÉÅ„É£ÈôêÂÆö</option>
                                        </select>
                                    </div>

                                    <!-- „Éü„É•„Éº„Çø„É≥„Éà„Éï„Ç£„É´„Çø„Éº -->
                                    <div class="col-12 col-md-3">
                                        <button id="filter-mutant-btn" class="btn btn-sm w-100 btn-mutant-filter py-1"
                                            onclick="toggleMutantFilter()"
                                            style="font-size: 0.8rem; white-space: nowrap; overflow: hidden; text-overflow: ellipsis;">
                                            ‚ú® „Éü„É•„Éº„Çø„É≥„Éà
                                        </button>
                                    </div>
                                </div>
                            </div>

                            <!-- „Éê„ÉÉ„Ç∏„Ç∞„É™„ÉÉ„Éâ -->
                            <div id="purchasable-badge-list" class="row g-3">
                                <!-- JS„ÅßÁîüÊàê -->
                            </div>

                            <!-- „Éö„Éº„Ç∏„Éç„Éº„Ç∑„Éß„É≥ -->
                            <nav id="badge-pagination-area" class="mt-4" style="display: none;">
                                <div class="d-flex justify-content-between align-items-center flex-wrap gap-2">
                                    <div class="text-muted small">
                                        <span id="badge-showing-info"></span>
                                    </div>
                                    <ul id="badge-pagination" class="pagination pagination-sm mb-0 pagination-premium">
                                        <!-- JS„ÅßÁîüÊàê -->
                                    </ul>
                                </div>
                            </nav>
                        </div>

                        <div id="no-badges-msg" class="text-center text-muted py-3" style="display: none;">
                            „Åæ„Å†„Éê„ÉÉ„Ç∏„ÇíÊåÅ„Å£„Å¶„ÅÑ„Åæ„Åõ„Çì
                        </div>
                    </div>

                    <!-- Ë≤©Â£≤ÂÆüÁ∏æ„Çª„ÇØ„Ç∑„Éß„É≥ -->
                    <div class="profile-card mb-4" id="revenue-section" style="display: none;">
                        <h4 style="font-family: var(--font-title); color: var(--deep-purple); margin: 0 0 15px 0;">
                            üí∞ Ë≤©Â£≤ÂÆüÁ∏æ
                        </h4>
                        <div class="row g-3">
                            <div class="col-6">
                                <div class="stat-card-mini">
                                    <div class="stat-label-mini">Á¥ØË®àÂèéÁõä</div>
                                    <div class="stat-value-mini" id="total-revenue" style="color: #27ae60;">0</div>
                                </div>
                            </div>
                            <div class="col-6">
                                <div class="stat-card-mini">
                                    <div class="stat-label-mini">Ë≤©Â£≤ÂõûÊï∞</div>
                                    <div class="stat-value-mini" id="revenue-count">0</div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- ÊúÄËøë„ÅÆÊ¥ªÂãï„Çª„ÇØ„Ç∑„Éß„É≥ (deployed 2026-01-12 13:27) -->
                    <div class="profile-card mb-4" id="activity-section" style="display: none;">
                        <div class="d-flex justify-content-between align-items-center flex-wrap gap-2 mb-3">
                            <h4 style="font-family: var(--font-title); color: var(--deep-purple); margin: 0;">
                                üìã ÊúÄËøë„ÅÆÊ¥ªÂãï
                            </h4>
                            <select id="activity-action-filter" class="form-select form-select-sm"
                                style="width: auto; font-size: 0.8rem;" onchange="loadActivityLogs(1)">
                                <option value="all">üîç „Åô„Åπ„Å¶</option>
                                <option value="mahjong">üÄÑ È∫ªÈõÄ</option>
                                <option value="transfer">üí∏ ÈÄÅÈáë</option>
                                <option value="badge">üéÅ „Éê„ÉÉ„Ç∏</option>
                                <option value="gacha_draw">‚õ©Ô∏è „ÅäË≥ΩÈä≠</option>
                                <option value="omikuji">üéã „Åä„Åø„Åè„Åò</option>
                                <option value="royalty_receive">üíé Â£≤‰∏äÈÇÑÂÖÉ</option>
                            </select>
                        </div>
                        <div id="activity-list">
                            <div class="text-center text-muted py-3">Ë™≠„ÅøËæº„Åø‰∏≠...</div>
                        </div>
                        <nav id="activity-pagination-area" class="mt-4" style="display: none;">
                            <ul id="activity-pagination"
                                class="pagination pagination-sm justify-content-center pagination-premium"></ul>
                        </nav>
                    </div>
                </div>

            </div>
        </div>
    </div>

    <!-- „Éê„ÉÉ„Ç∏Â§âÊõ¥„É¢„Éº„ÉÄ„É´ -->
    <div class="modal fade" id="badgeChangeModal" tabindex="-1" aria-labelledby="badgeChangeModalLabel"
        aria-hidden="true">
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title" id="badgeChangeModalLabel">Ë£ÖÁùÄ„Éê„ÉÉ„Ç∏„ÇíÂ§âÊõ¥</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <div class="modal-body">
                    <div class="text-center mb-3">
                        <span class="badge bg-primary me-2" id="badge-position-indicator">‚óÄ Â∑¶„Å´Ë£ÖÁùÄ</span>
                        <div class="btn-group" role="group">
                            <input type="radio" class="btn-check" name="badge-position" id="pos-left" value="left"
                                checked>
                            <label class="btn btn-outline-primary btn-sm" for="pos-left">‚óÄ Â∑¶</label>
                            <input type="radio" class="btn-check" name="badge-position" id="pos-right" value="right">
                            <label class="btn btn-outline-primary btn-sm" for="pos-right">Âè≥ ‚ñ∂</label>
                        </div>
                    </div>
                    <div id="badge-modal-list" class="row g-2">
                        <!-- JS„ÅßÁîüÊàê -->
                    </div>
                </div>
                <div class="text-center mt-3 d-grid gap-2">
                    <button class="btn btn-primary" id="btn-execute-equip" onclick="executeSelectedEquip()"
                        disabled>ÈÅ∏Êäû„Åó„Åü„Éê„ÉÉ„Ç∏„ÇíË£ÖÁùÄ</button>
                </div>
                <div class="text-center mt-3 d-flex justify-content-center gap-2">
                    <button class="btn btn-outline-danger btn-sm" onclick="equipBadge(null, 'left')">Â∑¶„ÇíÂ§ñ„Åô</button>
                    <button class="btn btn-outline-danger btn-sm" onclick="equipBadge(null, 'right')">Âè≥„ÇíÂ§ñ„Åô</button>
                </div>
            </div>
        </div>
    </div>
    </div>

    <!-- „Éã„ÉÉ„ÇØ„Éç„Éº„É†Á∑®ÈõÜ„É¢„Éº„ÉÄ„É´ -->
    <div class="modal fade" id="nicknameModal" tabindex="-1" aria-labelledby="nicknameModalLabel" aria-hidden="true">
        <div class="modal-dialog modal-sm">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title" id="nicknameModalLabel">„Éã„ÉÉ„ÇØ„Éç„Éº„É†Â§âÊõ¥</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <div class="modal-body">
                    <label class="form-label small text-muted">„É©„É≥„Ç≠„É≥„Ç∞Á≠â„ÅßË°®Á§∫„Åï„Çå„ÇãÂêçÂâç</label>
                    <input type="text" id="user-nickname" class="form-control mb-3" placeholder="„Éã„ÉÉ„ÇØ„Éç„Éº„É†„ÇíÂÖ•Âäõ...">
                    <div class="d-grid gap-2">
                        <button onclick="useDiscordName()" class="btn btn-outline-secondary btn-sm">
                            DiscordÂêç„Çí‰ΩøÁî®
                        </button>
                        <button onclick="saveNickname()" class="btn btn-gold text-white fw-bold">
                            ‰øùÂ≠ò
                        </button>
                    </div>
                    <div id="save-msg" class="small mt-2 text-center" style="display:none;"></div>
                </div>
            </div>
        </div>
    </div>

    <!-- „É≠„Éº„Éá„Ç£„É≥„Ç∞ -->
    <div id="loading-overlay" class="loading-overlay">
        <div class="spinner-border text-primary" role="status"></div>
    </div>

    <!-- ÊâÄÊåÅÂìÅ„É¢„Éº„ÉÄ„É´ -->
    <div class="modal fade" id="possessionsModal" tabindex="-1" aria-labelledby="possessionsModalLabel"
        aria-hidden="true">
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title" id="possessionsModalLabel">üéÅ „ÅÇ„Å™„Åü„ÅÆÊâÄÊåÅÂìÅ</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <div class="modal-body">
                    <div class="mb-4">
                        <h6 class="fw-bold border-bottom pb-2">„ÉÅ„Ç±„ÉÉ„Éà</h6>
                        <div
                            class="d-flex align-items-center justify-content-between p-3 bg-light rounded shadow-sm border">
                            <div class="d-flex align-items-center gap-2">
                                <span style="font-size: 1.5rem;">üßß</span>
                                <div>
                                    <div class="fw-bold" style="color: var(--deep-purple);">Á•àÈ°òÁ¨¶</div>
                                    <div class="small text-muted">„ÅäË≥ΩÈä≠Ôºà„Ç¨„ÉÅ„É£Ôºâ„Çí1ÂõûÂºï„Åë„Åæ„Åô</div>
                                </div>
                            </div>
                            <div class="fs-4 fw-bold text-primary"><span id="modal-tickets-count">0</span> Êûö</div>
                        </div>
                    </div>

                    <div>
                        <h6 class="fw-bold border-bottom pb-2">ÂºïÊèõÂà∏</h6>
                        <div id="exchange-tickets-list" class="row g-3">
                            <!-- JS„ÅßÁîüÊàê -->
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Bootstrap JS -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>
    <!-- Supabase -->
    <!-- „Éê„ÉÉ„Ç∏Âú®Â∫´„É¢„Éº„ÉÄ„É´Ôºà„Ç∑„Éß„ÉÉ„Éó„ÅÆÊâÄÊåÅ„Éê„ÉÉ„Ç∏UI„ÇíÊµÅÁî®Ôºâ -->
    <div class="modal fade" id="inventoryModal" tabindex="-1" aria-hidden="true">
        <div class="modal-dialog modal-dialog-centered modal-lg modal-dialog-scrollable">
            <div class="modal-content border-0 shadow-lg" style="border-radius: 20px;">
                <div class="modal-header border-bottom-0 pb-0">
                    <h5 class="modal-title" id="inventoryModalLabel">üéí „ÅÇ„Å™„Åü„ÅÆÊâÄÊåÅ„Éê„ÉÉ„Ç∏</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <div class="modal-body pt-2 bg-light">
                    <div class="row g-2 mb-3">
                        <div class="col-12 col-md-5">
                            <input type="text" id="inventory-search" class="form-control form-control-sm"
                                placeholder="„Éê„ÉÉ„Ç∏Âêç„ÅßÊ§úÁ¥¢..." oninput="filterAndRenderInventoryBadges()">
                        </div>
                        <div class="col-6 col-md-4">
                            <select id="inventory-sort" class="form-select form-select-sm"
                                onchange="filterAndRenderInventoryBadges()">
                                <option value="acquired_desc">ÂÖ•ÊâãÈ†ÜÔºàÊñ∞‚ÜíÂè§Ôºâ</option>
                                <option value="acquired_asc">ÂÖ•ÊâãÈ†ÜÔºàÂè§‚ÜíÊñ∞Ôºâ</option>
                                <option value="name_asc">ÂêçÂâçÈ†Ü</option>
                                <option value="rarity_desc">„É¨„Ç¢È†ÜÔºàÈ´ò‚Üí‰ΩéÔºâ</option>
                                <option value="rarity_asc">„É¨„Ç¢È†ÜÔºà‰Ωé‚ÜíÈ´òÔºâ</option>
                            </select>
                        </div>
                        <div class="col-6 col-md-3">
                            <select id="inventory-filter" class="form-select form-select-sm"
                                onchange="filterAndRenderInventoryBadges()">
                                <option value="all">„Éï„Ç£„É´„Çø„Éº: ÂÖ®‰ª∂</option>
                                <option value="fixed">Âõ∫ÂÆöÂûã</option>
                                <option value="variable">Â§âÂãïÂûã</option>
                                <option value="shrine">„ÅäË≥ΩÈä≠ÈôêÂÆö</option>
                                <option value="mutant">„Éü„É•„Éº„Çø„É≥„Éà</option>
                            </select>
                        </div>
                    </div>
                    <div id="inventory-list" class="vstack gap-2">
                        <div class="text-center py-4 text-muted">Ë™≠„ÅøËæº„Åø‰∏≠...</div>
                    </div>
                    <nav aria-label="Page navigation" class="mt-3" id="inventory-pagination-area" style="display:none;">
                        <ul class="pagination pagination-sm justify-content-center mb-0" id="inventory-pagination"></ul>
                    </nav>
                </div>
                <div class="modal-footer border-0 bg-light" style="border-radius: 0 0 20px 20px;">
                    <small class="text-muted" id="inventory-hint">
                        ‚Äª „Åì„Åì„Åã„ÇâÁõ¥Êé•Â£≤Âç¥/Ë≠≤Ê∏°„Åß„Åç„Åæ„Åô„ÄÇ
                    </small>
                    <button type="button" class="btn btn-outline-secondary btn-sm"
                        data-bs-dismiss="modal">Èñâ„Åò„Çã</button>
                </div>
            </div>
        </div>
    </div>

    <!-- ÂÖ±ÈÄö„Ç¢„ÇØ„Ç∑„Éß„É≥„É¢„Éº„ÉÄ„É´ÔºàÂ£≤Âç¥/Ë≠≤Ê∏°Á¢∫Ë™çÔºâ -->
    <div class="modal fade" id="shopActionModal" tabindex="-1" aria-hidden="true" style="z-index: 1060;">
        <div class="modal-dialog modal-dialog-centered">
            <div class="modal-content shadow-lg border-0" style="border-radius: 20px;">
                <div class="modal-body p-4 text-center">
                    <div id="shopActionContent"></div>
                    <div class="d-flex justify-content-center gap-3 mt-4">
                        <button type="button" class="btn btn-outline-secondary px-4"
                            data-bs-dismiss="modal">„Ç≠„É£„É≥„Çª„É´</button>
                        <button type="button" class="btn btn-danger px-4" id="btnShopActionExec">ÂÆüË°å</button>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- „É¶„Éº„Ç∂„ÉºÈÅ∏Êäû„É¢„Éº„ÉÄ„É´ (Ë≠≤Ê∏°„ÉªÈÄÅÈáëÁî®) -->
    <div class="modal fade" id="userSelectModal" tabindex="-1" aria-labelledby="userSelectModalLabel"
        aria-hidden="true">
        <div class="modal-dialog modal-dialog-scrollable">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title" id="userSelectModalLabel">Ë≠≤Ê∏°ÂÖà„ÅÆ„É¶„Éº„Ç∂„Éº„ÇíÈÅ∏Êäû</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <div class="modal-body p-0">
                    <div id="transfer-user-list" class="list-group list-group-flush">
                        <!-- JS„ÅßÁîüÊàê -->
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- „Ç≥„Ç§„É≥ÈÄÅÈáëÈáëÈ°çÂÖ•Âäõ„É¢„Éº„ÉÄ„É´ -->
    <div class="modal fade" id="coinAmountModal" tabindex="-1" aria-labelledby="coinAmountModalLabel"
        aria-hidden="true">
        <div class="modal-dialog modal-sm">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title" id="coinAmountModalLabel">ÈÄÅÈáëÈáëÈ°ç„ÇíÂÖ•Âäõ</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <div class="modal-body">
                    <p id="coin-transfer-target-name" class="fw-bold text-center mb-3"></p>
                    <div class="mb-3">
                        <label class="form-label">ÈÄÅÈáë„Åô„Çã„Ç≥„Ç§„É≥Êï∞</label>
                        <input type="number" id="coin-transfer-amount" class="form-control" placeholder="ÈáëÈ°ç..." min="1">
                        <div class="form-text mt-2 text-center">„ÅÇ„Å™„Åü„ÅÆÊâÄÊåÅÈáë: ü™ô <span id="my-coins-ref">0</span></div>
                    </div>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">„Ç≠„É£„É≥„Çª„É´</button>
                    <button type="button" class="btn btn-primary" onclick="executeCoinTransfer()">ÈÄÅÈáë„Åô„Çã</button>
                </div>
            </div>
        </div>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
    <!-- SupabaseË®≠ÂÆö -->
    <script src="../js/supabase-config.js?v=20260112"></script>
    <script src="../js/badge-utils.js"></script>
    <script src="../js/auth-guard.js"></script>
    <!-- „Äê‰∏ÄÊôÇÁöÑ„Äë„Ç¢„É≥„Ç±„Éº„Éà„É¢„Éº„ÉÄ„É´ÔºàÊí§ÂéªÊôÇ„ÅØ‰∏ã1Ë°å„ÇíÂâäÈô§Ôºâ -->
    <script src="../js/survey-modal.js"></script>
    <script src="../js/navigation.js"></script>
    <script src="../js/effects/mutant-badge.js"></script>
    <script src="../js/mypage/core.js"></script>
    <script src="../js/mypage/badges.js"></script>
    <script src="../js/mypage/activity.js"></script>
    <script src="../js/mypage/badge-inventory.js"></script>
    <script src="../js/mypage/badges-actions.js"></script>
    <script src="../js/mypage/mahjong-stats.js"></script>
    <script src="../js/mypage/transactions.js"></script>
    <script src="../js/mypage/team-notifications.js"></script>
</body>

</html>
